<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Notificações - Pilar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
    body { background-color: #f8f9fa; padding-bottom: 100px; }
    .container-main { max-width: 900px; margin: 30px auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }

    /* CABEÇALHO ESTILO PILAR */
    .header-pilar {
        background-color: #76b366; 
        color: white;
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 30px;
        display: flex;
        align-items: center;
        gap: 25px;
    }
    .header-pilar .bg-logo {
        background: white;
        padding: 15px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .header-pilar img { max-height: 50px; }
    .header-pilar h2 { margin: 0; font-weight: 700; letter-spacing: 1px; }
    .header-pilar p { margin: 0; opacity: 0.9; font-size: 0.95rem; }

    /* SELEÇÃO DE MODO */
    .nav-tabs-custom { border: none; justify-content: center; margin-bottom: 20px; gap: 10px; }
    .nav-link-custom { 
        border: none !important; 
        color: #6c757d; 
        font-weight: 600; 
        padding: 10px 20px;
        cursor: pointer;
    }
    .nav-link-custom.active { color: #5cb85c !important; text-decoration: underline; text-underline-offset: 8px; }

    /* TABELA DE PREENCHIMENTO */
    .table-input thead { background-color: #e9ecef; }
    .table-input input { border: 1px solid #dee2e6; padding: 5px 10px; width: 100%; border-radius: 4px; }
    .btn-remove { color: #dc3545; cursor: pointer; font-size: 1.2rem; border: none; background: none; }

    /* BOTÕES EMPRESA */
    .btn-empresa { border: 2px solid #dee2e6; border-radius: 10px; padding: 15px; transition: all 0.2s; background: white; }
    .btn-empresa.active { border-color: #5cb85c; box-shadow: 0 0 8px rgba(92, 184, 92, 0.3); }
    .btn-empresa img { height: 30px; margin-right: 10px; }

    /* TEMPLATE PDF (OCULTO) */
    #template-wrapper { position: fixed; top: 0; left: 0; z-index: -1000; opacity: 0; pointer-events: none; }
    .documento-a4 { width: 210mm; padding: 0; margin: 0; background: white; font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.5; color: #000; }
    #documento-modelo { max-width: 180mm; margin: 0 auto; }
    .header-logos { display: flex; justify-content: space-around; align-items: center; margin-bottom: 50px; height: 100px; }
    .logo-img { max-height: 90px; max-width: 200px; object-fit: contain; }
</style>
</head>
<body>

<div class="container container-main">
    <div class="header-pilar">
        <div class="bg-logo">
            <img src="assets/pilar-logo.png" alt="Pilar" onerror="this.src='https://via.placeholder.com/150x50?text=PILAR'">
        </div>
        <div>
            <h2>GERADOR DE NOTIFICAÇÕES</h2>
            <p>Sistema interno para emissão de documentos extrajudiciais.</p>
        </div>
    </div>

    <h6 class="text-center text-secondary mb-3 text-uppercase fw-bold" style="font-size: 0.8rem;">1. Selecione a Empresa Notificante</h6>
    <div class="row mb-5 g-3 justify-content-center">
        <div class="col-md-4">
            <button class="btn btn-empresa w-100 btn-empresa" data-empresa="nadia" onclick="selecionarEmpresa('nadia')">
                <img src="assets/nadia/logo-esq.png" alt="" onerror="this.style.display='none'"> Nadia Rural
            </button>
        </div>
        <div class="col-md-4">
            <button class="btn btn-empresa w-100 btn-empresa" data-empresa="inter" onclick="selecionarEmpresa('inter')">
                <img src="assets/inter/logo-esq.png" alt="" onerror="this.style.display='none'"> Inter
            </button>
        </div>
        <div class="col-md-4">
            <button class="btn btn-empresa w-100 btn-empresa" data-empresa="agrominas" onclick="selecionarEmpresa('agrominas')">
                <img src="assets/agrominas/logo-esq.png" alt="" onerror="this.style.display='none'"> Agrominas
            </button>
        </div>
    </div>

    <div id="area-dados" style="display:none;">
        <h6 class="text-center text-secondary mb-3 text-uppercase fw-bold" style="font-size: 0.8rem;">2. Insira os Dados dos Notificados</h6>
        
        <ul class="nav nav-tabs-custom">
            <li class="nav-item">
                <a class="nav-link-custom active" id="tab-excel" onclick="alternarModo('excel')">Colar do Excel</a>
            </li>
            <li class="nav-item">
                <a class="nav-link-custom" id="tab-tela" onclick="alternarModo('tela')">Preencher na Tela</a>
            </li>
        </ul>

        <div id="modo-excel">
            <div class="alert alert-light border text-muted small">
                <strong>Ordem das colunas:</strong> NOME | CPF/CNPJ | VALOR
            </div>
            <textarea class="form-control mb-4" id="inputDataExcel" rows="6" placeholder="Ex: João Silva	123.456.789-00	R$ 1.500,00"></textarea>
        </div>

        <div id="modo-tela" style="display: none;">
            <div class="table-responsive border rounded mb-3">
                <table class="table table-input m-0">
                    <thead>
                        <tr class="small text-muted">
                            <th width="40%">Nome do Cliente</th>
                            <th width="30%">CPF ou CNPJ</th>
                            <th width="25%">Valor (R$)</th>
                            <th width="5%"></th>
                        </tr>
                    </thead>
                    <tbody id="tabela-corpo">
                        <tr>
                            <td><input type="text" class="input-nome"></td>
                            <td><input type="text" class="input-cnpj"></td>
                            <td><input type="text" class="input-valor"></td>
                            <td><button class="btn-remove" onclick="removerLinha(this)">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <button class="btn btn-success btn-sm mb-4" onclick="adicionarLinha()">+ Adicionar Linha</button>
        </div>

        <div class="d-grid">
            <button class="btn btn-primary btn-lg fw-bold" onclick="iniciarGeracao()" id="btnGerar" style="background-color: #3b71ed; border: none;">
                Gerar PDFs e Baixar ZIP
            </button>
        </div>
        <div id="status" class="mt-3 text-center fw-bold"></div>
    </div>

    <div id="alerta-selecao" class="alert alert-warning text-center">
        Selecione uma empresa acima para liberar a inserção de dados.
    </div>
</div>

<div id="template-wrapper">
    <div id="documento-modelo" class="documento-a4">
        <div class="header-logos">
            <img src="" id="logo-print-esq" class="logo-img">
            <img src="" id="logo-print-dir" class="logo-img">
        </div>
        <div id="template-texto"></div>
        <p style="text-align: right; margin-top: 40px;" id="print-data"></p>
        <div class="assinatura" style="text-align: right; margin-top: 50px;">
            <img src="" id="assinatura-img" style="height: 60px; margin-bottom: 5px; display: block; margin-left: auto;">
            <strong id="assinatura-nome-advogado"></strong><br>
            <span id="assinatura-oab"></span>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>
